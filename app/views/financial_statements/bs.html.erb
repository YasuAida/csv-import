<h1>貸借対照表推移表</h1>

<div class="container-fluid">
  <div class="row">
    <div class="col-xs-12">
    
      <%= form_for(@show_period, url: bs_financial_statements_path , method: :get) do |f| %>
        <label><%= f.radio_button :monthly_yearly, "月次", {:checked => true}%>月次</label>
        <label><%= f.radio_button :monthly_yearly, "年次" %>年次</label>
        <label><%= f.submit "切替" %></label>
      <% end %>
      
      <div style="overflow: hidden;">
        <table class="table table-striped table-bordered" border="1" style="float: left; display: inline-block; width: 150px; overflow-x: scroll;">
          <thead class="financial">
            <tr><th>　</th></tr>
          </thead>
          <tbody class="financial">
            <% @bs_accounts.each do |bs| %>
              <tr><td><%= bs.account %></td></tr>
            <% end %>
          </tbody>
        </table>
    
        <table class="table table-striped table-bordered" border="1" style="float: left; max-width: 82%; display: inline-block; overflow-x: scroll;">
          <thead class="financial">
            <tr>
              <% @show_periods.each do |e| %>
                <% if e.monthly_yearly == "月次" %>
                 <th style="white-space: nowrap; margin: 0;"><%= e.period_start.strftime(" %Y年 %m月 ") %></th>
                <% else %>
                 <th><%= e.period_start.strftime(" %Y年 ") %></th>
                <% end %>
              <% end %>
           </tr>
          </thead>
          
          <tbody class="financial">
            <% @bs_accounts.each do |bs| %>
              <tr>
                <% count_period = @show_periods.count %>
                <% 0.upto(count_period-1) do |i| %>
                  <% target_period = @show_periods[i] %>
                  <% target_data = FinancialStatement.find_by(period_start: target_period.period_start, monthly_yearly: target_period.monthly_yearly, account: bs.account) %>
                  <td align="right"><%= addcomma(target_data.amount.to_i) if target_data.present? %></td>
                <% end %> 
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>