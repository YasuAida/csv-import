<% content_for :head do %> 
  <div class="panel_container">
    <div class="panel panel-default">
      <div class="panel-heading">
        楽天設定シート
      </div>
    </div>
  </div>

  <div class="table-responsive">  
    <table class="table table-striped table-bordered table-condensed">
      <thead>
        <tr>
          <th class="update"><a href= /rakuten_settings/destroy class="btn btn-default btn-sm">削除</th>
          <th class="large">設定期間<br>開始日</th>          
          <th class="large">設定期間<br>終了日</th>            
          <th class="large">売上金額</th>      
          <th class="amount">ＰＣ料率</th>
          <th class="amount">モバイル料率</th>          
          <th class="update">更新</th>          
        </tr>
      </thead>
<% end %>
      <tbody class="expenseledgers">
        <% @rakuten_settings.each do |rakuten_setting|  %>
        <tr>
          <%= form_for(rakuten_setting, url: rakuten_setting_path(rakuten_setting.id), remote: true) do |f| %>
            <td class="update" id="check-<%= rakuten_setting.id %>"><%= f.check_box :destroy_check, {}, "true", "false" %></td>       
            <td class="large"><%= f.text_field :start_date, :size => 9 %>から</td>            
            <% if rakuten_setting.end_date.blank? %>
              <td class="large"><%= Date.today %>まで</td>
            <% else %>
              <td class="large"><%= f.text_field :end_date, :size => 9 %>まで</td>
            <% end %>
            <td class="large"><%= f.text_field :end_sales, :size => 8, :style=>"text-align:right", data: { autonumeric: {mDec: 0} } %>まで</td>
            <td class="amount"><%= f.text_field :pc_rate, :size => 7, :style=>"text-align:right" %>％</td>
            <td class="amount"><%= f.text_field :mobile_rate, :size => 7, :style=>"text-align:right" %>％</td>                    
            <td class="update" id="submit-<%= rakuten_setting.id %>"><%= f.submit "更新", class: 'btn btn-default btn-sm'%></td>
            
            <!--チェックボックス更新用JQuery-->
            <script>
              $("#check-<%= rakuten_setting.id %>").change(function(e){
                $('#edit_rakuten_setting_<%= rakuten_setting.id %>').submit();
              });
            </script>
          <% end %> 
        </tr>  
        <% end %>
      </tbody>
<% content_for :foot do %> 
        <%= form_for(@rakuten_setting) do |f|  %>
      <tbody class="footer">
        <tr>
          <td class="update"></td>
          <td class="large"><%= f.text_field :start_date, :size => 9 %>から</td>
          <td class="large"><%= f.text_field :end_date, :size => 9, :placeholder => '未定は空欄' %>まで</td>       
          <td class="large"><%= f.text_field :end_sales, :size => 8, :placeholder => '最後は空欄', :style=>"text-align:right", data: { autonumeric: {mDec: 0} } %>まで</td>
          <td class="amount"><%= f.text_field :pc_rate, :size => 7, :style=>"text-align:right" %>％</td>
          <td class="amount"><%= f.text_field :mobile_rate, :size => 7, :style=>"text-align:right" %>％</td> 
          <td class="update"><%= f.submit "登録", class: 'btn btn-default btn-sm'%></td>
        </tr> 
        <% end %>
      </tbody>
    </table>
  </div>

  <div style="display: inline-block;">
    <p>Download:
      <%= link_to "CSV形式でダウンロード", rakuten_settings_path(format: "csv") %>
    </p>
  </div>
<% end %>

